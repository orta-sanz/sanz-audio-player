!function(a){var b={once:function(a,b){var c;return function(){return a&&(c=a.apply(b||this,arguments),a=null),c}},getParsedLength:function(a){var b=Math.floor(a/60);return a-=60*b,(10>b?"0"+b:b)+":"+(10>a?"0"+Math.floor(a):Math.floor(a))},clickPercent:function(a,c){return(b.pointerEventToXY(a).x-c.offset().left)/c.outerWidth()},pointerEventToXY:function(a){var b={x:0,y:0};if("touchstart"==a.type||"touchmove"==a.type||"touchend"==a.type||"touchcancel"==a.type){if(a.touches||a.changedTouches||a.originalEvent.touches||a.originalEvent.changedTouches){if(a.touches&&a.touches[0])var c=a.touches[0];else var c=a.originalEvent.changedTouches[0];b.x=c.pageX,b.y=c.pageY}}else b.x=a.pageX,b.y=a.pageY;return b}},c={audioControl:!0,volume:1};a.fn.sanzAudio=function(d){function j(){function n(a){var c=i.timeline.outerWidth()-i.timeToggle.outerWidth(),d=b.pointerEventToXY(a).x-i.timeline.offset().left;d>=0&&c>=d&&i.timeToggle.css("left",d+"px"),0>d&&i.timeToggle.css("left","0px"),d>c&&i.timeToggle.css("left",c+"px"),f.prop("currentTime",h*b.clickPercent(a,i.timeline))}function o(a){var c=i.audio.outerWidth()-i.audioToggle.outerWidth(),d=b.pointerEventToXY(a).x-i.audio.offset().left;d>=0&&c>=d&&i.audioToggle.css("left",d+"px"),0>d&&i.audioToggle.css("left","0px"),d>c&&i.audioToggle.css("left",c+"px");var e=b.clickPercent(a,i.audio);(0>e||e>1)&&(e=e>1?1:0),s(e),f.prop("volume",e)}function p(){j=!0,k="audio";var a="ontouchstart"in window?"touchmove":"mousemove";window.addEventListener(a,o,!0)}function q(){j=!0,k="time";var a="ontouchstart"in window?"touchmove":"mousemove";window.addEventListener(a,n,!0)}function r(a){if(1==j){var b="ontouchstart"in window?"touchmove":"mousemove";"audio"==k&&window.removeEventListener(b,o,!0),"time"==k&&window.removeEventListener(b,n,!0)}j=!1}function s(a){var b;a>=.7?b='<i class="icono-volumeHigh"></i>':a>=.5&&.7>a?b='<i class="icono-volumeMedium"></i>':a>.2&&.5>a?b='<i class="icono-volumeLow"></i>':.2>=a&&(b='<i class="icono-volume"></i>'),d.find(".sanz_audio_controls.volume").find("i").remove(),d.find(".sanz_audio_controls.volume").append(b)}var c='<div class="sanz_audio">';c+='<div class="sanz_audio_controls play-pause"><i class="icono-play"></i></div>',c+='<div class="sanz_audio_controls progress"><span class="sanz_audio_controls progress_control"></span></div>',c+='<div class="sanz_audio_time">00:00</div>',e.audioControl&&(c+='<div class="sanz_audio_controls volume"><i class="icono-volumeHigh"></i></div>',c+='<div class="sanz_audio_controls volume_control"><span class="volume_control_toggler"></span></div>'),c+="</div>",f.after(c),f.css("display","none","important");var d=f.next(".sanz_audio"),i={play:d.find(".sanz_audio_controls.play-pause"),timeline:d.find(".sanz_audio_controls.progress"),timeToggle:d.find(".sanz_audio_controls.progress_control"),audio:d.find(".sanz_audio_controls.volume_control"),audioToggle:d.find(".sanz_audio_controls .volume_control_toggler"),audioIcon:d.find(".sanz_audio_controls.volume")},j=!1,k=null,l=b.getParsedLength(h);if(h&&d.find(".sanz_audio_time").html(l),setTimeout(function(){h||(h=f.prop("duration"),l=b.getParsedLength(h),d.find(".sanz_audio_time").html(l))},1200),i.play.on("click",function(){var b=a(this).find("i");f.prop("paused")?(f.trigger("play"),b.removeClass("icono-play").addClass("icono-pause")):(f.trigger("pause"),b.removeClass("icono-pause").addClass("icono-play"))}),f.bind("timeupdate",function(){var a=b.getParsedLength(h-f.prop("currentTime"));d.find(".sanz_audio_time").html(a);var c=Math.floor(100*f.prop("currentTime")/h);i.timeToggle.css("left",c+"%")}),s(e.volume),e.volume>1||1==e.volume)f.prop("volume",1),i.audioToggle.css("right","0px");else if(e.volume<0||0==e.volume)f.prop("volume",0),i.audioToggle.css("left","0px");else{f.prop("volume",e.volume);var m=i.audio.width()*e.volume/1;i.audioToggle.css("left",m+"px")}e.audioControl&&i.audioIcon.on("click",function(a){if(f.prop("volume")>0)f.prop("volume",0),g=f.prop("volume"),i.audioToggle.css("left","0px");else if(0==g)g=1,f.prop("volume",1),i.audioToggle.css("left",""),i.audioToggle.css("right","0px");else{f.prop("volume",g);var b=i.audio.width()*g/1;b>i.audio.width()||1==g?(i.audioToggle.css("left",""),i.audioToggle.css("right","0px")):i.audioToggle.css("left",b+"px")}s(f.prop("volume"))}),f.on("ended",function(){j||(i.timeToggle.css("left","0px"),d.find(".sanz_audio_time").html(l),i.play.removeClass("icono-pause").addClass("icono-play"))}),e.audioControl&&i.audioToggle.on("touchstart mousedown",p),i.timeToggle.on("touchstart mousedown",q),a(window).on("touchend mouseup",r),e.audioControl&&i.audio.on("click",function(a){var c=b.clickPercent(event,i.audio);c>=0&&1>=c&&(f.prop("volume",c),g=c,s(c),o(a))}),i.timeline.on("click",function(a){n(a),f.prop("currentTime",h*b.clickPercent(event,i.timeline))})}var e=a.extend({},c,d),f=a(this),g=f.prop("volume"),h=f.prop("duration"),i=b.once(j);f.on("canplaythrough",i),f.prop("readyState")>3&&i()}}(jQuery);